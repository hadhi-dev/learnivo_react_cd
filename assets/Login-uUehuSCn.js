import{h as e}from"./vendor-ui-D-W4xDah.js";import{L as S}from"./index-9Ntr3LAE.js";import{a as r,h as I,i as L,j as C}from"./vendor-react-pOJj_1mY.js";import{y as i}from"./vendor-alerts-CMxmQAUU.js";import{A as E}from"./CONSTANTS-CNTqIkkT.js";import{G as P}from"./GetAPI-C0R9K2iB.js";import{l as T}from"./authUtils-Cl3aMeRo.js";import{m as s,M as k,L as D,c as A}from"./vendor-other-BEndW8qv.js";import"./config-BbshSSl6.js";import"./vendor-forms-CxLqLCH9.js";import"./vendor-recharts-pV3kltCe.js";const V=()=>{const[n,d]=r.useState({username:"",password:""}),[m,l]=r.useState(!1),x=r.useRef(null),h=r.useRef(null),y=r.useRef(null),o=I(),{usid:u}=L(),[g]=C(),j=()=>{const t=localStorage.getItem("loginTime"),a=new Date().getTime(),p=1440*60*1e3;t&&a-t>p&&(localStorage.clear(),i.warning("Session expired. Please login again.",{position:"top-right",autoClose:2e3}),o("/login"))};r.useEffect(()=>{j(),u&&v(u);const t=g.get("email"),a=g.get("password");t&&a&&(d({username:t,password:a}),b(t,a,!0))},[u,o,g]),r.useEffect(()=>{if(window.location.pathname==="/login"){const t=localStorage.getItem("uid");localStorage.getItem("aid")==="true"&&o("/admin"),t>0&&o("/home")}},[o]),r.useEffect(()=>{var t;(t=y.current)==null||t.focus()},[]);const v=async t=>{localStorage.clear();try{l(!0);const{data:a}=await P(`login/${t}`);a?(i.success("Login Successful",{autoClose:2e3}),localStorage.setItem("isLoggedIn","true"),localStorage.setItem("udt",JSON.stringify(a)),localStorage.setItem("uid",a.userID),localStorage.setItem("usid",t),localStorage.setItem("loginTime",new Date().getTime()),o("/home")):i.warning("Kindly login with your credentials",{autoClose:2e3})}catch(a){console.error("Error in direct login:",a)}finally{l(!1)}},b=async(t=n.username,a=n.password,p=!1)=>{if(!t||!a){p||i.error("Please enter both email and password.");return}try{l(!0);const f=await T({email:t,password:a}),{code:N,message:w,data:c}=f;N===200?(i.success(w,{autoClose:2e3}),localStorage.clear(),localStorage.setItem("isLoggedIn","true"),localStorage.setItem("udt",JSON.stringify(c)),localStorage.setItem("uid",c.userID),localStorage.setItem("loginTime",new Date().getTime()),t==="7598548786"?(localStorage.setItem("aid","true"),localStorage.setItem("usid",c.usid),o("/admin")):(localStorage.setItem("usid",c.usid),o("/home"))):i.error(w,{autoClose:2e3})}catch(f){i.error("An error occurred: "+f.message,{autoClose:3e3})}finally{l(!1)}};return e.jsxs(e.Fragment,{children:[m&&e.jsx(S,{}),e.jsxs("div",{className:"relative min-h-screen overflow-hidden bg-gradient-to-br from-indigo-50 via-white to-purple-50",children:[e.jsx(s.div,{animate:{rotate:360},transition:{duration:30,repeat:1/0,ease:"linear"},className:"absolute -top-40 -right-40 h-80 w-80 rounded-full bg-indigo-200 opacity-20 blur-3xl"}),e.jsx(s.div,{animate:{rotate:-360},transition:{duration:35,repeat:1/0,ease:"linear"},className:"absolute -bottom-40 -left-40 h-80 w-80 rounded-full bg-purple-200 opacity-20 blur-3xl"}),e.jsx("div",{className:"relative z-10 flex min-h-screen flex-col items-center justify-center px-4 py-12 sm:px-6 lg:px-8",children:e.jsxs(s.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6},className:"w-full max-w-md",children:[e.jsxs("div",{className:"rounded-3xl border border-white/20 bg-white/80 p-8 shadow-2xl backdrop-blur-sm sm:p-10",children:[e.jsx(s.div,{whileHover:{scale:1.05},className:"mb-8 text-center",children:e.jsx("a",{href:"/",children:e.jsx("img",{src:E.LOGO,alt:"Company Logo",className:"mx-auto w-32 sm:w-40"})})}),e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("h1",{className:"mb-3 bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-3xl font-bold text-transparent sm:text-4xl",children:"Welcome Back"}),e.jsx("p",{className:"text-sm text-gray-600 sm:text-base",children:"Sign in to your account to continue learning"})]}),e.jsxs(s.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},className:"mb-6",children:[e.jsx("label",{htmlFor:"username",className:"mb-2 block text-sm font-semibold text-gray-700",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute top-1/2 left-4 -translate-y-1/2 transform text-indigo-500",size:20}),e.jsx("input",{type:"email",id:"username",ref:y,placeholder:"Enter your email address",tabIndex:"1",value:n.username,onChange:t=>d({...n,username:t.target.value}),onKeyUp:t=>{var a;t.key==="Enter"&&((a=h.current)==null||a.focus())},className:"w-full rounded-xl border-2 border-gray-200 bg-white py-3 pr-4 pl-12 transition-all duration-300 outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200"})]})]}),e.jsxs(s.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.4,delay:.2},className:"mb-2",children:[e.jsx("label",{htmlFor:"password",className:"mb-2 block text-sm font-semibold text-gray-700",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(D,{className:"absolute top-1/2 left-4 -translate-y-1/2 transform text-indigo-500",size:20}),e.jsx("input",{type:"password",id:"password",placeholder:"Enter your password",ref:h,tabIndex:"2",value:n.password,onChange:t=>{const a=t.target.value;if(a.length>8){i.error("Password must be max 8 characters",{autoClose:2e3});return}d({...n,password:a})},onKeyUp:t=>{var a;t.key==="Enter"&&((a=x.current)==null||a.click())},className:"w-full rounded-xl border-2 border-gray-200 bg-white py-3 pr-4 pl-12 transition-all duration-300 outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200"})]})]}),e.jsx("div",{className:"mb-8 text-right",children:e.jsx("a",{href:"/forget-password",className:"text-sm font-medium text-indigo-600 transition-colors hover:text-purple-600",children:"Forgot your password?"})}),e.jsxs(s.button,{type:"button",ref:x,onClick:()=>b(),whileHover:{scale:1.02},whileTap:{scale:.98},className:"group flex w-full items-center justify-center gap-2 rounded-xl bg-gradient-to-r from-indigo-600 to-purple-600 px-6 py-3 font-semibold text-white shadow-lg transition-all duration-300 hover:from-indigo-700 hover:to-purple-700",children:[m?"Logging in...":"Sign In",!m&&e.jsx(A,{className:"transition-transform group-hover:translate-x-1",size:20})]}),e.jsxs(s.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"mt-8 text-center text-sm text-gray-600",children:["Don't have an account yet?"," ",e.jsx("a",{href:"/register",className:"font-semibold text-indigo-600 transition-colors hover:text-purple-600",children:"Sign up"})]})]}),e.jsx(s.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"mt-8 text-center text-xs text-gray-500 sm:text-sm",children:e.jsx("p",{children:"Secure learning platform powered by learnivo"})})]})})]})]})};export{V as default};
